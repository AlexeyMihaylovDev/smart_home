# Решение проблем с подключением

## Проблема: Не удается подключиться к Home Assistant

### 1. Проверьте доступность сервера

Убедитесь, что Home Assistant доступен по указанному адресу:

```bash
# В браузере откройте:
http://192.168.3.12:8123
```

Если страница не открывается:
- Проверьте, что Home Assistant запущен
- Проверьте правильность IP адреса
- Проверьте, что порт 8123 открыт

### 2. Проверьте токен доступа

1. Откройте Home Assistant
2. Перейдите в **Профиль** (иконка внизу слева)
3. Прокрутите вниз до раздела **Long-Lived Access Tokens**
4. Создайте новый токен, если его нет
5. Скопируйте токен полностью (он очень длинный)

### 3. Настройка CORS (если необходимо)

Если вы видите ошибки CORS в консоли браузера, нужно добавить ваш домен в список разрешенных:

1. Откройте файл `configuration.yaml` в Home Assistant
2. Добавьте или обновите секцию `http:`:

```yaml
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 127.0.0.1
    - ::1
  cors_allowed_origins:
    - http://localhost:3000
    - http://127.0.0.1:3000
    - http://192.168.3.12:3000
```

3. Перезапустите Home Assistant

### 4. Тестирование подключения

Запустите тестовый скрипт:

```bash
# Установите axios если его нет
npm install axios

# Запустите тест
node test-connection.js
```

Этот скрипт проверит:
- Доступность сервера
- Правильность токена
- Возможность получения данных

### 5. Проверка в консоли браузера

Откройте консоль разработчика (F12) и проверьте:
- Нет ли ошибок CORS
- Какой статус код возвращает сервер
- Детали ошибки в Network tab

### 6. Частые ошибки

**Ошибка 401 (Unauthorized)**
- Неверный токен
- Токен истек
- Решение: создайте новый токен

**Ошибка 404 (Not Found)**
- Неверный URL
- Решение: проверьте URL, должен быть `http://192.168.3.12:8123`

**Ошибка Network Error / CORS**
- Проблема с CORS
- Решение: настройте CORS в Home Assistant (см. пункт 3)

**Таймаут**
- Сервер недоступен
- Решение: проверьте доступность Home Assistant

### 7. Альтернативный способ подключения

Если проблемы с CORS продолжаются, можно использовать прокси в Vite:

Файл `vite.config.ts` уже настроен для проксирования запросов. Убедитесь, что в настройках указан правильный адрес Home Assistant.

